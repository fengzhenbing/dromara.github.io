<!doctype html><html><head><title>Scripts · dromara(Open source organization)</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The girl on the prairie"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=/img/favicon.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-187960192-2','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome Dromara</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/projects/sofa-acts/usage-script/><span>中文</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a>
<a class=navbar-item href=/awesome/>Awesome Dromara</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/projects/sofa-acts/usage-script/>中</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>Scripts</h1><a class="edit-button -hidden-mobile" href=https://github.com/dromara/edit/master/content/en/projects/sofa-acts/usage-script/index.md>Edit</a></div><div class=meta>Update time: 2021-01-24</div></div><article class=typo><h2 id=quickly-understand-acts-scripts>Quickly understand ACTS scripts</h2><p>Do you have to frequently compile test cases? Are you frustrated by the following problems?</p><ul><li>You have to repeat assertEquals, which is definitely not creative.</li><li>Missing an assert may lead to false success, while mistaking one may ruin your mood.</li><li>If the scenario is complex, the test code may be longer than the service code, which is painful.</li><li>You have to migrate utility classes every time you start writing test cases for a new application.</li></ul><p>A TestNG test case is shown on the left side, and an ACTS test case on the right. Repeated coding is gone, and the code size is significantly reduced. Unlike ordinary test scripts, ACTS scripts inherit from the ActsTestBase class, which is encapsulated with data loading methods, driving methods, execution engines, and validation rules. Users do not have to clean or prepare data, run test cases, or validate results. ACTS implements zero coding for simple services, which greatly reduces the coding and maintenance costs.</p><p><img src=testng-vs-acts.png alt="TestNG vs ACTS"></p><h2 id=generate-test-scripts>Generate test scripts</h2><p>Prerequisites: <strong>Be sure to use Maven to compile your project and generate the object model. Otherwise, ACTS IDE may encounter unexpected errors, such as edit failures and incorrect data.</strong></p><p>Right click a the method defined in the interface and select ACTS Function &gt; Generate Test Case.</p><p><img src=generate-test-case.png alt="Generate test cases"></p><p><img src=test-script-generation.png alt="Test script generation wizard"></p><p><img src=generated-data.png alt="Automatic content generation"></p><h2 id=run-test-script>Run test script</h2><p>Method: Right click the tested method in ACTS script, and select TestNG to run the test script as shown in the following figure.</p><p><img src=debug.png alt=Debug></p><h2 id=specify-a-test-script-to-run>Specify a test script to run</h2><ol><li><p>Set <code>test_only＝^T</code> in <code>src/test/resource/config/acts-config.properties</code> to run only the test case whose name starts with <code>T</code>. You can also replace <code>^T</code> with other regular expressions.</p></li><li><p>In this case, you can modify the name of the test case that you want to run by adding <code>T</code> in front of its name. ACTS only runs a test case whose name starts with <code>T</code>.</p></li></ol><p><img src=change-case-name.png alt="Modify the current use case name"></p><p><img src=enter-case-name.png alt="Enter the test case name"></p><p><img src=result.png alt=Result></p><h2 id=split-test-cases-of-the-test-script>Split test cases of the test script</h2><p>ACTS stores all test case data of a test script in the same YAML file by default. You can determine whether to store test case data by test script or by test case by configuring the option <code>spilt_yaml_by_case</code>.
It is set to false by default, which means all test case data of the same test script is stored in one YAML file.</p><p>You can set <code>spilt_yaml_by_case=true</code> in <code>acts-config.properties</code> to store each test case of a new test script in a separate YAML file that is named after the case ID. This reduces the chances of file conflicts in the case where multiple developers work on the same interface.</p><p>In addition, ACTS provides a utility class that allows you split a legacy YAML file of a specified test script under a specified path by test case. See the following.</p><p><strong>BaseDataUtil.saveYamlDataToCaseByCase</strong></p><ul><li>Note: Before the split, we recommend that you rename the original YAML file for backup, and then use the test case editor to check whether the content of the split files is correct. The original YAML file must be deleted if the split files are correct, because they cannot coexist.</li></ul><h2 id=coding-for-data-preparation>Coding for data preparation</h2><p>ACTS provides context APIs in the ActsRuntimeContext class for data preparation as follows:</p><ul><li>Quickly get and set custom parameters:</li></ul><p>Get all custom parameters: <code>getParamMap getParamMap()</code>
Get custom parameters by key: <code>Object getParamByName(String paraName)</code>
Add custom parameters: <code>void addOneParam(String paraName, Object paraObj)</code>
Replace custom parameters: <code>void setParamMap(Map&lt;String, Object&gt; paramMap)</code>
Get custom parameters by using a generic method: <code>T getParamByNameWithGeneric(String paraName)</code></p><ul><li>Quickly get and set test case request parameters</li></ul><p>Get all request parameters: <code>List getInputParams()</code>
Get request parameters by position: <code>Object getInputParamByPos(int i)</code>
Add request parameters for the test case: <code>void addInputParam(Object obj)</code></p><ul><li>Quickly get and set response expectations</li></ul><p>Get response expectations: <code>Object getExpectResult()</code>
Set response expectations: <code>Boolean setExpectResult(Object objToSet)</code></p><h2 id=use-of-the-mock-function>Use of the Mock function</h2><p>The Mock function is currently based on the Mockito solution. For details, see the <a href=https://static.javadoc.io/org.mockito/mockito-core/2.18.3/org/mockito/Mockito.html>Mockito documentation in English</a> or <a href=https://github.com/hehonghui/mockito-doc-zh>Mockito documentation in Chinese.</a></p><h3 id=add-the-dependency>Add the dependency</h3><p>Add the following dependency to the test module (skip this step if you have already introduced the test starter of SOFABoot)</p><pre><code class=language-xml>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre><p>By default, the Mockito version that Spring test depends on is 1.x. If you want to upgrade the version, exclude it first before you import the new version.</p><pre><code class=language-xml>&lt;dependency&gt;
    &lt;groupId&gt;org.mockito&lt;/groupId&gt;
    &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;
    &lt;version&gt;2.18.3&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><p><strong>Mockito</strong> is used for stubbing during testing. You can use it to specify the value to be returned by a specific method of a class under a certain condition. The Mockito library enables object mocking, verification and stubbing. The sample code is as follows:</p><pre><code class=language-java>@SpringBootTest(classes = SOFABootApplication.class)
@TestExecutionListeners(listeners = MockitoTestExecutionListener.class)
public class RegisterUserActsTest extends ActsTestBase {

    @TestBean
    @Autowired
    // This is the test class
    public UserService userService;

    @MockBean
    // This is the bean to be mocked
    public AccountManageFacadeClient accountManageFacadeClient;

    @Test(dataProvider = &quot;ActsDataProvider&quot;)
    public void registerUser
                (String caseId, String desc, PrepareData prepareData) {
        runTest(caseId, prepareData);
    }

    @Override
    public void beforeActsTest(ActsRuntimeContext actsRuntimeContext) {
        super.beforeActsTest(actsRuntimeContext);
        AccountManageResult accountManageResult = new AccountManageResult();
        accountManageResult.setAccountNo(&quot;testAccount&quot;);
        accountManageResult.setOperateDt(new Date());
        accountManageResult.setSuccess(true);
        Mockito.when(accountManageFacadeClient.openAccount(Mockito.any(NormalOpenAccountRequest.class))).thenReturn(accountManageResult);
    }

    public void setUserService(UserService userService) {
        this.userService = userService;
    }
}
</code></pre></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/dromara>Github</a>
<a class=link href=https://gitee.com/shuaiqiyu>Gitee</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/dromara/soul/issues/new>Feedback</a>
<a class=link href=/community>Community</a>
<a class=link href=/blog>Blog</a></div><div class=cate><h2 class=cate-title>Document</h2><a class=link href=/projects/soul/overview/>Soul</a>
<a class=link href=/projects/hmily/overview/>Hmily</a>
<a class=link href=/projects/raincat/overview/>Raincat</a>
<a class=link href=/projects/myth/overview/>Myth</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>QQ Group</p></div></div></div><div class=copyright><p>Copyright ©2021
<a href=/>xiaoyu@apache.org by xiaoyu</a></p></div></footer></body></html>