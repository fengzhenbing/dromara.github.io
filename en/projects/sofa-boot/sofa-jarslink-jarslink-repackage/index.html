<!doctype html><html><head><title>Application packaging · dromara(Open source organization)</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The girl on the prairie"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=/img/favicon.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-187960192-2','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome Dromara</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a>
<a class=navbar-item href=/awesome/>Awesome Dromara</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>Application packaging</h1><a class="edit-button -hidden-mobile" href=https://github.com/dromara/edit/master/content/en/projects/sofa-boot/sofa-jarslink-jarslink-repackage/index.md>Edit</a></div><div class=meta>Update time: 2021-01-24</div></div><article class=typo><h2 id=introduction>Introduction</h2><p>To understand the usage mode of Jarslink2.0, you need to have a certain understanding of the <a href=https://github.com/sofastack/sofa-ark>SOFAArk framework</a> and <a href=../sofa-ark-ark-jar>the packaging of Ark packages</a> and <a href=../sofa-ark-ark-biz>Ark Biz</a> packages.</p><p>To ensure the consistency of reading, here is a rough description of the packaging logic of the application&rsquo;s use of Jarslink2.0. The official recommendation is to jump to the above-mentioned link to obtain the necessary background knowledge.</p><p>Jarslink2.0 requires an application type of <a href=https://spring.io/projects/spring-boot>Spring Boot</a> or <a href=https://github.com/sofastack/sofa-boot>SOFABoot</a>. Before introducing new modes of application packaging, let&rsquo;s see why it is necessary for Spring Boot/SOFABoot applications to introduce new packaging modes after using Jarslink2.0.</p><h2 id=background>Background</h2><p>At runtime, Jarslink2.0 works as an <a href=../sofa-ark-ark-plugin>Ark Plugin</a> of the SOFAArk framework, which must be introduced for the use of Jarslink2.0. The Jarslink2.0 plugin will not be loaded and started until the SOFAArk container is started. As we know, when official Spring Boot projects use plugins:</p><pre><code class=language-xml>&lt;plugin&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
&lt;/plugin&gt;
</code></pre><p>An executable FatJar will be packaged, which contains all the dependencies, configurations, and other resources required by the running application. The FatJar entry method is the main method of the Spring Boot application. The packaging logic of a SOFABoot project is the same as that of a Spring Boot project.</p><p>After the application introduces Jarslink2.0, which needs to depend on the SOFAArk framework, the FatJar that is packaged by a new packaging mode needs to contain a SOFAArk container. The FatJar entry method also needs to be replaced by the SOFAArk container startup method, because the startup of SOFAArk takes precedence over the execution of the FatJar. The SOFAArk container starts all the Ark Plugins in turn before finally starting the application. Therefore, a new packaging mode is needed, and SOFAArk provides a packaging plugin.</p><pre><code class=language-xml> &lt;plugin&gt;
    &lt;groupId&gt;com.alipay.sofa&lt;/groupId&gt;
    &lt;artifactId&gt;sofa-ark-maven-plugin&lt;/artifactId&gt;
&lt;/plugin&gt;
</code></pre><p>responsible for packaging Spring Boot/SOFABoot applications into an executable FatJar called <a href=../sofa-ark-ark-jar>Ark package</a>.</p><h2 id=packaging-type>Packaging Type</h2><p>In the previous section, we have described why the use of Jarslink 2.0 needs to introduce a packaging mode that is different from the official Spring Boot packaging mode, and brought out the first packaging type—Ark package. Now let&rsquo;s summarize the features of Ark package:</p><ul><li>Ark package is an executable FatJar package format customized by the SOFAArk framework, the details of which are available in <a href=../sofa-ark-ark-jar>Reference Documents</a>.</li><li>The Ark package contains all the configurations, dependencies, and other resources required by the running application. Its packaging logic is similar to that of Spring Boot, and it also contains the Ark Plugin and the SOFAArk framework on which the application depends. The SOFAArk framework does not need to be introduced into the application by the application developers with the traditional label <code>&lt;dependency/&gt;</code>, but is automatically packaged by the above-mentioned packaging plugin <code>sofa-ark-maven-plugin</code>. The version of SOFAArk framework is that of the packaging plugin.</li></ul><p>For easy understanding, let&rsquo;s put it this way: Ark package = Spring Boot FatJar + SOFAArk framework + Ark Plugin. In the new packaging logic, SOFAArk has more rationally reorganized the Spring Boot FatJar into another format, which leads to the application&rsquo;s second packaging type—Biz package. The features of Biz package are summarized as follows:</p><ul><li><p>The Biz package is a FatJar package format customized by the SOFAArk framework, the details of which are available in <a href=../sofa-ark-ark-biz>Reference Documents</a>.</p></li><li><p>Similar to the FatJar packaged by the Spring Boot packaging plugin, Biz package contains all the configurations, dependencies, and other resources required by the running application. Note that the only difference is that it cannot run directly with the <code>java -jar</code> command.</p></li></ul><p>Therefore, we can actually see it this way: Ark package = Biz package + SOFAArk framework + Ark Plugin.</p><p>In conclusion, with the packaging plugin provided by SOFAArk, the application</p><pre><code class=language-xml> &lt;plugin&gt;
    &lt;groupId&gt;com.alipay.sofa&lt;/groupId&gt;
    &lt;artifactId&gt;sofa-ark-maven-plugin&lt;/artifactId&gt;
&lt;/plugin&gt;
</code></pre><p>can package two types of packages—Ark package and Biz package.</p><h2 id=packaging-configuration>Packaging Configuration</h2><p>Detailed use of the packaging plugin <code>sofa-ark-maven-plugin</code> is available in <a href=../sofa-ark-ark-jar>Reference Documents</a>. The following is an attached simple packaging configuration:</p><pre><code class=language-xml>&lt;build&gt;
    &lt;plugin&gt;
        &lt;groupId&gt;com.alipay.sofa&lt;/groupId&gt;
        &lt;artifactId&gt;sofa-ark-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${sofa.ark.plugin.version}&lt;/version&gt;
        &lt;executions&gt;
            &lt;execution&gt;
                &lt;id&gt;default-cli&lt;/id&gt;
                &lt;goals&gt;
                    &lt;goal&gt;repackage&lt;/goal&gt;
                &lt;/goals&gt;
            &lt;/excution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
            &lt;attach&gt;false&lt;/attach&gt;
        &lt;/configuration&gt;
    &lt;/plugin&gt;
&lt;/build&gt;
</code></pre><p>Note the configuration of &ldquo;attach&rdquo;, which mainly affects the installation and release of the Biz package. When attach is configured and released as true, execute the mvn install command and the Biz package will be installed in the local maven repository. When the mvn deploy command is executed, the Biz package will also be uploaded to the remote maven repository. The GAV coordinates of the Biz package is determined by the pom.xml file, with the additional attribute of classifier=ark-biz. For the role of classifier, refer to the <a href=https://stackoverflow.com/questions/20909634/what-is-the-purpose-of-mavens-dependency-declarations-classifier-property>StackOverFlow Q&amp;A</a></p></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/dromara>Github</a>
<a class=link href=https://gitee.com/shuaiqiyu>Gitee</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/dromara/soul/issues/new>Feedback</a>
<a class=link href=/community>Community</a>
<a class=link href=/blog>Blog</a></div><div class=cate><h2 class=cate-title>Document</h2><a class=link href=/projects/soul/overview/>Soul</a>
<a class=link href=/projects/hmily/overview/>Hmily</a>
<a class=link href=/projects/raincat/overview/>Raincat</a>
<a class=link href=/projects/myth/overview/>Myth</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>QQ Group</p></div></div></div><div class=copyright><p>Copyright ©2021
<a href=/>xiaoyu@apache.org by xiaoyu</a></p></div></footer></body></html>