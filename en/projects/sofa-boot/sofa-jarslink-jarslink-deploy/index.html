<!doctype html><html><head><title>Merged deployment · dromara(Open source organization)</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The girl on the prairie"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=/img/favicon.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-187960192-2','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome Dromara</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a>
<a class=navbar-item href=/awesome/>Awesome Dromara</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>Merged deployment</h1><a class="edit-button -hidden-mobile" href=https://github.com/dromara/edit/master/content/en/projects/sofa-boot/sofa-jarslink-jarslink-deploy/index.md>Edit</a></div><div class=meta>Update time: 2021-01-24</div></div><article class=typo><p>In Jarslink 2.0, merged deployment refers to loading and running multiple Biz packages in the same JVM. In the section <a href=../sofa-jarslink-jarslink-repackage>Application Packaging</a>, we have described the relationship between the Spring Boot/SOFABoot application and the Biz package. We may think that merged deployment here refers to loading and running multiple Spring Boot/SOFABoot applications in the same JVM.</p><p>It is mentioned at the end of <a href=../sofa-jarslink-jarslink-repackage>Application Packaging</a> that a Biz package can be released to a remote repository through the mvn deploy command, similar to releasing common Jar packages. It comes naturally to mind that the advantage of doing so is that the Biz package generated by other applications can be introduced in the form of dependencies, just like introducing common Jar package dependencies. Then, what is the purpose of introducing the Biz package generated by other applications into your application? Also, how do we dynamically install and uninstall Biz packages in Jarslink 2.0?</p><p>To answer the two questions above is to understand the concepts of static merged deployment and dynamic merged deployment.</p><h2 id=static-merged-deployment>Static merged deployment</h2><p>To answer the first question: What is the purpose of introducing the Biz package generated by other applications into your application?</p><p>In the section <a href=../sofa-jarslink-jarslink-repackage>Application Packaging</a>, we have described how to package an application into an Ark package and offered a rough equation: Ark package = Biz package + SOFAArk framework + Ark Plugin. When a Biz package generated by other applications is introduced in the application, what kind of packaged Ark package will it be? The conclusion is that the packaging plugin will treat special dependency packages like the Biz package differently. The plugin will package all the non-Biz package dependencies into the application&rsquo;s Biz package, but will consider the introduced Biz package as equal to those of the current application. The final Ark package will contain multiple Biz packages. For details, refer to <a href=../sofa-ark-ark-jar>Ark Package Directory Structure</a>. At this point, when you use java -jar to start this Ark package, you will find that all the contained Biz packages will be started as well.</p><p>To sum up, the application introduces the Biz packages generated by other applications in the form of dependencies, and the Ark package packaged by this application will contain multiple Biz packages. By executing this Ark package, all the Biz packages will be started, known as static merged deployment.</p><p>Static merged deployment does not depend on Jarslink 2.0 but is available directly with the SOFAArk packaging plugin.</p><p><strong>Note that the startup order of multiple Biz packages is controllable. When each Biz package is generated, you can use the packaging plugin to configure its priority, whose value is 100 by default. The higher the priority, the lower the value is. The priority determines the startup order of the Biz package.</strong></p><h2 id=dynamic-merged-deployment>Dynamic merged deployment</h2><p>To answer the second question: how do you dynamically install and uninstall Biz packages in Jarslink 2.0?</p><p>Instead of static merged deployment, Jarslink2.0 enables the SOFAArk framework to dynamically install and uninstall the Biz package. If the Ark package contains the Jarslink2.0 plugin, Jarslink2.0 can receive dynamic commands to install or uninstall a Biz package. Currently, Jarslink2.0 only supports command interaction by way of the telnet protocol through port 1234. To access the interface of Jarslink2.0, start the Ark package and execute <code>telnet ip 1234</code>. We plan to introduce interaction through http requests in Version 0.2.0.</p><p>Detailed information about the command syntax of Jarslink2.0 is given in <a href=../sofa-jarslink-jarslink-instruction>Jarslink Interactive Commands</a>. Now, we will focus on how to use Jarslink2.0 to perform application hot updates. Hot update here means to switch an application from an older version to a newer one without suspending the services that the application is delivering.</p><p>Jarslink2.0 identifies a Biz package only by its name and version number during the merged deployment. The name and version number of a Biz package is generated during the plugin packaging and recorded in the MANIFEST.MF file. Jarslink2.0 allows simultaneous installation of several versions of Biz packages with the same name, but only one can deliver services at a time. The service here refers to the JVM service published by the Biz package. For detailed information about the JVM service, see <a href=../module-service>Ark Biz Communications</a>. When Jarslink2.0 has installed two different versions of Biz packages with the same name, you can send a command to switch the version that provides services. In this way, you can perform hot updates while ensuring service continuity.</p><p><strong>Note that multiple web applications are not supported in either static merged deployment or dynamic merged deployment.</strong></p></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/dromara>Github</a>
<a class=link href=https://gitee.com/shuaiqiyu>Gitee</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/dromara/soul/issues/new>Feedback</a>
<a class=link href=/community>Community</a>
<a class=link href=/blog>Blog</a></div><div class=cate><h2 class=cate-title>Document</h2><a class=link href=/projects/soul/overview/>Soul</a>
<a class=link href=/projects/hmily/overview/>Hmily</a>
<a class=link href=/projects/raincat/overview/>Raincat</a>
<a class=link href=/projects/myth/overview/>Myth</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>QQ Group</p></div></div></div><div class=copyright><p>Copyright ©2021
<a href=/>xiaoyu@apache.org by xiaoyu</a></p></div></footer></body></html>