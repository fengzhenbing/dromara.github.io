<!doctype html><html><head><title>Basic model · dromara(Open source organization)</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The girl on the prairie"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=/img/favicon.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-187960192-2','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome Dromara</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/projects/sofa-rpc/common-model/><span>中文</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a>
<a class=navbar-item href=/awesome/>Awesome Dromara</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/projects/sofa-rpc/common-model/>中</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>Basic model</h1><a class="edit-button -hidden-mobile" href=https://github.com/dromara/edit/master/content/en/projects/sofa-rpc/common-model/index.md>Edit</a></div><div class=meta>Update time: 2021-01-24</div></div><article class=typo><h2 id=messages>Messages</h2><p>All messages are internally passed through <code>SofaRequest</code> and <code>SofaResponse</code>.</p><p>To convert to other protocols, you need to transform the messages to the objects that are to be actually transferred when calling and receiving requests.</p><p>The modules that can write <code>SofaRequest</code> and <code>SofaResponse</code> are as follows:</p><ul><li>Invoker</li><li>Filter</li><li>ServerHandler</li><li>Serialization</li></ul><p>The modules that can only read message bodies are as follows:</p><ul><li>Cluster</li><li>Router</li><li>LoadBalance</li></ul><h2 id=logs>Logs</h2><p>The log initialization is based on the extension mechanism. Since the log loading should be done earliest, there is a separate key in <code>rpc-config.json</code>.</p><pre><code class=language-json>{
  / / Log implementation is done earlier than configuration loading, so it cannot adapt to the extension mechanism
  &quot;logger.impl&quot;: &quot;com.alipay.sofa.rpc.log.MiddlewareLoggerImpl&quot;
}
</code></pre><h2 id=configuration-items>Configuration items</h2><h3 id=rpc-configuration-for-users>RPC configuration for users</h3><p>The user configuration includes port configuration (although the fields for setting port in the objects have been opened, SOFA gets those fields from the configuration file by default), thread pool size configuration, and other configurations.</p><ul><li>Load the configuration via <code>SofaConfigs</code> and call <code>ExternalConfigLoader</code> to read external properties.</li><li>Get the configuration through the API provided by <code>SofaConfigs</code>.</li><li>All the internally configured keys are in the <code>SofaOptions</code> class.</li><li>Priority: <code>System.property</code> &gt; <code>sofa-config.properties</code> (one for each application) &gt; <code>rpc-config.properties</code>.</li></ul><h3 id=rpc-framework-configuration>RPC framework configuration</h3><p>The configuration of the framework itself, such as default serialization and default timeout. In the future, SOFARPC may support the configuration for multiple ClassLoaders.</p><ul><li>Load the configuration file via <code>RpcConfigs</code>.</li><li>Get and listen to data changes via the API provided by <code>RpcConfigs</code></li><li>All internally configured keys are in the <code>RpcOptions</code> class</li><li>Priority: <code>System.property</code> &gt; <code>custom rpc-config.json</code> (There may be multiple custom configuration files which are sorted in certain order) &gt; <code>rpc-config-default.json</code>.</li></ul><h3 id=constants>Constants</h3><ul><li><p>The global basic constants are in <code>RpcConstants</code>. For example:
 </p><ul><li>Calling method (sync/oneway)</li><li>Protocol (bolt/grpc/rest); serialization (hessian/java/protobuf)</li><li>Context key</li></ul></li><li><p>If the extension implements its own constants, you need to maintain the constants yourself. For example:</p><ul><li>The constants of BOLT protocol<ul><li>SERIALIZE_CODE_HESSIAN = 1</li><li>PROTOCOL_TR = 13</li></ul></li><li>The constants related with DSR Configuration Center<ul><li>The keys specific for DSR Configuration Center, such as _WEIGHT and _CONNECTTIMEOUT</li></ul></li></ul></li></ul><h3 id=address>Address</h3><ul><li>The address information of provider is placed in the <code>ProviderInfo</code> class.</li><li>The value of <code>ProviderInfo</code> is mainly divided into three parts:<ul><li>Fields, which are generally required items, such as IP, port and status.</li><li>Static fields, such as application name.</li><li>Dynamic fields, such as warm-up weight.</li></ul></li><li>Field enumerations are maintained in the <code>ProviderInfoAttrs</code> class.</li></ul></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/dromara>Github</a>
<a class=link href=https://gitee.com/shuaiqiyu>Gitee</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/dromara/soul/issues/new>Feedback</a>
<a class=link href=/community>Community</a>
<a class=link href=/blog>Blog</a></div><div class=cate><h2 class=cate-title>Document</h2><a class=link href=/projects/soul/overview/>Soul</a>
<a class=link href=/projects/hmily/overview/>Hmily</a>
<a class=link href=/projects/raincat/overview/>Raincat</a>
<a class=link href=/projects/myth/overview/>Myth</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>QQ Group</p></div></div></div><div class=copyright><p>Copyright ©2021
<a href=/>xiaoyu@apache.org by xiaoyu</a></p></div></footer></body></html>