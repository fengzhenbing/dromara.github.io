<!doctype html><html><head><title>Spring MVC Integration · dromara(Open source organization)</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The girl on the prairie"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=/img/favicon.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-187960192-2','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome Dromara</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/projects/sofa-tracer/usage-of-mvc/><span>中文</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a>
<a class=navbar-item href=/awesome/>Awesome Dromara</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/projects/sofa-tracer/usage-of-mvc/>中</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>Spring MVC Integration</h1><a class="edit-button -hidden-mobile" href=https://github.com/dromara/edit/master/content/en/projects/sofa-tracer/usage-of-mvc/index.md>Edit</a></div><div class=meta>Update time: 2021-01-24</div></div><article class=typo><p>In this document will demonstrate how to use SOFATracer to track of SpringMVC, this example <a href=https://github.com/sofastack-guides/sofa-tracer-guides/tree/master/tracer-sample-with-springmvc>address</a>.</p><p>Assuming you have built a simple Spring Web project based on SOFABoot, Then you can be operated by the following steps:</p><h2 id=introduce-dependency>Introduce dependency</h2><pre><code class=language-xml>&lt;dependency&gt;
    &lt;groupId&gt;com.alipay.sofa&lt;/groupId&gt;
    &lt;artifactId&gt;tracer-sofa-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><h2 id=project-configuration>Project Configuration</h2><p>Then, add the parameters to be used by SOFATracer in the project&rsquo;s <code>application.properties</code> file, including <code>spring.application.name</code> that indicates the name of the current application and <code>logging.path</code> that specifies the log output directory.</p><pre><code class=language-properties># Application Name
spring.application.name=SOFATracerSpringMVC
# logging path
logging.path=./logs
</code></pre><h2 id=add-a-simple-controller>Add a simple Controller</h2><p>In the project code, add a simple Controller, for example:</p><pre><code class=language-java>@RestController
public class SampleRestController {

    private static final String TEMPLATE = &quot;Hello, %s!&quot;;

    private final AtomicLong    counter  = new AtomicLong();

    /**
     * http://localhost:8080/springmvc
     * @param name name
     * @return map
     */
    @RequestMapping(&quot;/springmvc&quot;)
    public Map&lt;String, Object&gt; springmvc(@RequestParam(value = &quot;name&quot;, defaultValue = &quot;SOFATracer SpringMVC DEMO&quot;) String name) {
        Map&lt;String, Object&gt; resultMap = new HashMap&lt;String, Object&gt;();
        resultMap.put(&quot;success&quot;, true);
        resultMap.put(&quot;id&quot;, counter.incrementAndGet());
        resultMap.put(&quot;content&quot;, String.format(TEMPLATE, name));
        return resultMap;
    }
}
</code></pre><h2 id=run-the-project>Run the project</h2><p>Start Current SOFABoot Application. You will see the log about startup in the console:</p><pre><code>2018-05-11 11:55:11.932  INFO 66490 --- [ost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'SpringMvcOpenTracingFilter' to urls: [/*]
2018-05-11 11:55:13.961  INFO 66490 --- [           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 8080 (http)
2018-05-11 11:55:13.970  INFO 66490 --- [           main] c.a.s.t.e.springmvc.DemoApplication      : Started DemoApplication in 8.361 seconds (JVM running for 9.34)
</code></pre><p>You can access the REST service by visiting <a href=http://localhost:8080/springmvc>http://localhost:8080/springmvc</a> in your browser. You can see the result similar to the followings:</p><pre><code class=language-json>{
    content: &quot;Hello, SOFATracer SpringMVC DEMO!&quot;,
    id: 1,
    success: true
}
</code></pre><h2 id=view-log>View log</h2><p>In the <code>application.properties</code>, the log printing directory we configured is <code>./logs</code>, which is the root directory of the current application (we can configure it based on actual situation). In the root directory, you can see log files in the structure similar to the followings:</p><pre><code>./logs
├── spring.log
└── tracelog
    ├── spring-mvc-digest.log
    ├── spring-mvc-stat.log
    ├── static-info.log
    └── tracer-self.log
</code></pre><p>Every time you visit <a href=http://localhost:8080/springmvc>http://localhost:8080/springmvc</a>, SOFATracer will log the digest log. You can open the <code>spring-mvc-digest.log</code> file to see the specific log content. As for the meaning of each output field, you <a href=../usage-of-mvc>can refer to here</a>.</p><pre><code class=language-json>{&quot;time&quot;:&quot;2018-05-17 22:20:34.279&quot;,&quot;local.app&quot;:&quot;SOFATracerSpringMVC&quot;,&quot;traceId&quot;:&quot;0a0fe9391526566833985100139443&quot;,&quot;spanId&quot;:&quot;0&quot;,&quot;request.url&quot;:&quot;http://localhost:8080/springmvc&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;result.code&quot;:&quot;200&quot;,&quot;req.size.bytes&quot;:-1,&quot;resp.size.bytes&quot;:69,&quot;time.cost.milliseconds&quot;:284,&quot;current.thread.name&quot;:&quot;http-nio-8080-exec-1&quot;,&quot;baggage&quot;:&quot;&quot;}

</code></pre></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/dromara>Github</a>
<a class=link href=https://gitee.com/shuaiqiyu>Gitee</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/dromara/soul/issues/new>Feedback</a>
<a class=link href=/community>Community</a>
<a class=link href=/blog>Blog</a></div><div class=cate><h2 class=cate-title>Document</h2><a class=link href=/projects/soul/overview/>Soul</a>
<a class=link href=/projects/hmily/overview/>Hmily</a>
<a class=link href=/projects/raincat/overview/>Raincat</a>
<a class=link href=/projects/myth/overview/>Myth</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>QQ Group</p></div></div></div><div class=copyright><p>Copyright ©2021
<a href=/>xiaoyu@apache.org by xiaoyu</a></p></div></footer></body></html>